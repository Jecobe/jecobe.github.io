<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Adblock Detector</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: #0f1115;
      color: #e5e7eb;
    }
    .wrap {
      height: 100%;
      display: grid;
      place-items: center;
      text-align: center;
      gap: 1rem;
      padding: 2rem;
    }
    #status {
      font-size: clamp(3rem, 12vw, 10rem);
      font-weight: 800;
      letter-spacing: 0.06em;
      line-height: 1;
    }
    .yes { color: #ef4444; }   /* red */
    .no  { color: #22c55e; }   /* green */
    #details {
      opacity: .7;
      font-size: 0.95rem;
      max-width: 800px;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div id="status">Checkingâ€¦</div>
    <div id="details">This page checks for element-hiding and blocked ad-script requests.</div>
  </div>

  <script>
    // --- Element-hiding bait test (common adblock filter target classes) ---
    function baitHidden() {
      const bait = document.createElement('div');
      bait.className = 'ad ads ad-container ad-banner adsbox advertisement sponsored adsbygoogle';
      bait.style.cssText = 'position:absolute;left:-9999px;top:-9999px;width:1px;height:1px;';
      document.body.appendChild(bait);

      const cs = window.getComputedStyle(bait);
      const hidden =
        cs.display === 'none' ||
        cs.visibility === 'hidden' ||
        bait.offsetParent === null ||
        bait.clientHeight === 0 ||
        bait.offsetHeight === 0;

      bait.remove();
      return hidden;
    }

    // --- External script block test (commonly blocked ad JS) ---
    function scriptBlocked(url, timeoutMs = 2500) {
      return new Promise((resolve) => {
        const s = document.createElement('script');
        let done = false;
        const cleanup = (blocked) => {
          if (done) return;
          done = true;
          s.remove();
          resolve(blocked);
        };
        const timer = setTimeout(() => cleanup(false), timeoutMs); // timeout => assume not blocked

        s.src = url;
        s.async = true;
        s.onload = () => { clearTimeout(timer); cleanup(false); };
        s.onerror = () => { clearTimeout(timer); cleanup(true); };
        document.head.appendChild(s);
      });
    }

    async function detectAdblock() {
      // Run tests in parallel
      const [elHidden, gadsBlocked, gptBlocked] = await Promise.all([
        Promise.resolve().then(baitHidden),
        scriptBlocked('https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js'),
        scriptBlocked('https://securepubads.g.doubleclick.net/tag/js/gpt.js'),
      ]);

      // Heuristic: adblock if element hiding hit OR any ad script blocked
      return elHidden || gadsBlocked || gptBlocked;
    }

    (async () => {
      try {
        const blocked = await detectAdblock();
        const el = document.getElementById('status');
        el.textContent = blocked ? 'YES' : 'NO';
        el.className = blocked ? 'yes' : 'no';
        document.getElementById('details').textContent =
          blocked ? 'Ad blocker (or DNS/content blocking) detected.'
                  : 'No ad blocker detected (or it did not block our tests).';
      } catch (e) {
        const el = document.getElementById('status');
        el.textContent = 'UNKNOWN';
        el.className = '';
        document.getElementById('details').textContent =
          'Detection failed (network/CSP errors).';
      }
    })();
  </script>
</body>
</html>
